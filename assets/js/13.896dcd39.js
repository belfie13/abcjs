(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{307:function(t,a,e){var s=e(1),n=e(4),r=e(93),o=[].slice,c=function(t){return function(a,e){var s=arguments.length>2,n=s?o.call(arguments,2):void 0;return t(s?function(){("function"==typeof a?a:Function(a)).apply(this,n)}:a,e)}};s({global:!0,bind:!0,forced:/MSIE .\./.test(r)},{setTimeout:c(n.setTimeout),setInterval:c(n.setInterval)})},465:function(t,a,e){"use strict";e.r(a);e(307);var s={mounted:function(){var t=this;setTimeout((function(){t.callbacks=[t.$refs.timingCallbacks]}),500)},data:function(){return{callbacks:[]}}},n=e(44),r=Object(n.a)(s,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"timing-callbacks"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#timing-callbacks"}},[t._v("#")]),t._v(" Timing Callbacks")]),t._v(" "),e("p",[t._v("This runs an animation timer and does callbacks at various intervals. This allows you to do various effects that are timed with beats or playing notes.")]),t._v(" "),e("h2",{attrs:{id:"creation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#creation"}},[t._v("#")]),t._v(" Creation")]),t._v(" "),e("p",[t._v("To use this create an instance of it:")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" timingCallbacks "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("abcjs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TimingCallbacks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("visualObj"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" params"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("table",[e("thead",[e("tr",[e("th",[t._v("Parameters")]),t._v(" "),e("th",[t._v("Description")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("visualObj")]),t._v(" "),e("td",[t._v("This is the output of the "),e("code",[t._v("renderAbc()")]),t._v(" call. It is the music that will be timed.")])]),t._v(" "),e("tr",[e("td",[t._v("params")]),t._v(" "),e("td",[t._v("This is a object. See below for the possible properties.")])])])]),t._v(" "),e("h2",{attrs:{id:"parameters"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#parameters"}},[t._v("#")]),t._v(" Parameters")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("Name")]),t._v(" "),e("th",[t._v("Default")]),t._v(" "),e("th",[t._v("Description")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("code",[t._v("qpm")])]),t._v(" "),e("td",[t._v("whatever is in the Q: field")]),t._v(" "),e("td",[t._v("Number of beats per minute.")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("extraMeasuresAtBeginning")])]),t._v(" "),e("td",[t._v("0")]),t._v(" "),e("td",[t._v("Don't start the callbacks right away, but insert this number of measures first.")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("beatCallback")])]),t._v(" "),e("td",[t._v("null")]),t._v(" "),e("td",[t._v("Called for each beat passing the beat number (starting at 0).")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("eventCallback")])]),t._v(" "),e("td",[t._v("null")]),t._v(" "),e("td",[t._v("Called for each event (either a note, a rest, or a chord, and notes in separate voices are grouped together.)")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("lineEndCallback")])]),t._v(" "),e("td",[t._v("null")]),t._v(" "),e("td",[t._v("Called at the end of each line. (This is useful if you want to be sure the music is scrolled into view at the right time.) See "),e("code",[t._v("lineEndAnticipation")]),t._v(" for more details.")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("lineEndAnticipation")])]),t._v(" "),e("td",[t._v("0")]),t._v(" "),e("td",[t._v("The number of milliseconds for the "),e("code",[t._v("lineEndCallback")]),t._v(" to anticipate end of the line. That is, if you want to get the callback half a second before the end of the line, use 500.")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("beatSubdivisions")])]),t._v(" "),e("td",[t._v("1")]),t._v(" "),e("td",[t._v("How many callbacks should happen for each beat. This allows finer control in the client, for instance, to handle a progress bar.")])])])]),t._v(" "),e("h2",{attrs:{id:"callbacks"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#callbacks"}},[t._v("#")]),t._v(" Callbacks")]),t._v(" "),e("h3",{attrs:{id:"beatcallback"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#beatcallback"}},[t._v("#")]),t._v(" beatCallback")]),t._v(" "),e("p",[t._v("This is called once for every beat in the tune. It is called one additional time when the tune is finished.")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("beatCallback")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("beatNumber"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" totalBeats"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" totalTime")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("table",[e("thead",[e("tr",[e("th",[t._v("Name")]),t._v(" "),e("th",[t._v("Description")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("beatNumber")]),t._v(" "),e("td",[t._v("Zero-based beat number. Usually this will increment sequentially and regularly, but if javascript is paused long enough (for instance, if the browser tab is changed), then there may be a number of these calls at once when it catches up.")])]),t._v(" "),e("tr",[e("td",[t._v("totalBeats")]),t._v(" "),e("td",[t._v("The total number of beats (including all repeats) that will be played.")])]),t._v(" "),e("tr",[e("td",[t._v("totalTime")]),t._v(" "),e("td",[t._v("The total number of milliseconds of the tune.")])])])]),t._v(" "),e("h3",{attrs:{id:"eventcallback"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#eventcallback"}},[t._v("#")]),t._v(" eventCallback")]),t._v(" "),e("p",[t._v('This is called once for every "event" in time - either a note or a rest. If there are multiple notes at the same time, then it is only called once\nfor that group of notes.')]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("eventCallback")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("ev")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("The parameter "),e("code",[t._v("ev")]),t._v(" is an object that looks like this:")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[t._v("ev "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"event"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// This is always "event"')]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"milliseconds"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The number of milliseconds from the beginning of the piece")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"millisecondsPerMeasure"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The number of milliseconds per measure")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"line"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// The current "line", that is, the staff system.')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"measureNumber"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The measure number. Resets per line, so the first measure number on a line is zero.")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"top"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The number of pixels from the top of the svg that the note appears.")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"height"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The height of the note, in pixels. ")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"left"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The number of pixels from the left edge of the svg.")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"width"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The width of the note")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"elements"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Array of the actual elements on the page that are represented by the note or notes.")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"startCharArray"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" number "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// the character position in the original abc string")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"endCharArray"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" number "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// the character position in the original abc string")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"midiPitches"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Array of the currently playing pitches")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pitch"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The pitch number (based on the midi standard, i.e. middle C is 60)")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"durationInMeasures"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// the note value as a fraction. (that is, a quarter note is 0.025)")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"volume"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The volume expressed as a number between 0 and 127")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"instrument"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The instrument number (based on the midi standard, i.e. acoustic_grand_piano is 0)")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h4",{attrs:{id:"notes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#notes"}},[t._v("#")]),t._v(" Notes:")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("The "),e("code",[t._v("startCharArray")]),t._v(" and "),e("code",[t._v("endCharArray")]),t._v(" are arrays because there is more than one location in the abc string if there is more than one voice.")])]),t._v(" "),e("li",[e("p",[t._v("The format of the "),e("code",[t._v("elements")]),t._v(" array is subject to change in future versions.")])])]),t._v(" "),e("h3",{attrs:{id:"lineendcallback"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#lineendcallback"}},[t._v("#")]),t._v(" lineEndCallback")]),t._v(" "),e("p",[t._v("This will be called as the cursor is approaching the end of a line of music. This is useful if there is more than a screen's worth of music; it can be used to scroll the page at the right time.")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("lineEndCallback")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("info")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("The parameter "),e("code",[t._v("info")]),t._v(" looks like this:")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[t._v("info "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"milliseconds"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// current milliseconds from beginning of piece")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"top"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The number of pixels from the top of the svg to the top of the cursor")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bottom"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The number of pixels from the top of the svg to the bottom of the cursor")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h2",{attrs:{id:"functions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#functions"}},[t._v("#")]),t._v(" Functions")]),t._v(" "),e("p",[t._v("These are the entry points that can be called on the "),e("code",[t._v("timingCallbacks")]),t._v(" object.")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("Name")]),t._v(" "),e("th",[t._v("Description")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("replaceTarget(visualObj)")]),t._v(" "),e("td",[t._v("If the underlying music changes on the fly, this replaces the current object without having to destroy the object and start over.")])]),t._v(" "),e("tr",[e("td",[t._v("start()")]),t._v(" "),e("td",[t._v("Start or resume the animation immediately.")])]),t._v(" "),e("tr",[e("td",[t._v("pause()")]),t._v(" "),e("td",[t._v("Pause the animation. After calling this, the next call to "),e("code",[t._v("start()")]),t._v(" will pick up where it left off.")])]),t._v(" "),e("tr",[e("td",[t._v("reset()")]),t._v(" "),e("td",[t._v("Move the timer back to the beginning, so the animation starts over.")])]),t._v(" "),e("tr",[e("td",[t._v("stop()")]),t._v(" "),e("td",[t._v("Stop the animation. After calling this, the next call to "),e("code",[t._v("start()")]),t._v(" will start at the beginning.")])]),t._v(" "),e("tr",[e("td",[t._v("setProgress(percent)")]),t._v(" "),e("td",[t._v("Change the position of the animation. This allows random access to any place in the tune.")])])])]),t._v(" "),e("h2",{attrs:{id:"example"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#example"}},[t._v("#")]),t._v(" Example")]),t._v(" "),e("p",[t._v('Paste in any ABC you want here then click "start" to see what is returned by the timing callbacks:')]),t._v(" "),e("example-tune-book",{attrs:{callbacks:t.callbacks,"tune-id":32}}),t._v(" "),e("timing-callbacks",{ref:"timingCallbacks",attrs:{target:"#abc"}})],1)}),[],!1,null,null,null);a.default=r.exports}}]);